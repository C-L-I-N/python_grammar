# 📘 Day 23 - 虚拟环境 (Virtual Environment)

## 🤔 为什么需要虚拟环境？

想象一下这个场景：

- **项目A** 需要 Django 2.0
- **项目B** 需要 Django 4.0

如果所有包都安装在全局环境中，就会产生**版本冲突**！

> **虚拟环境** 可以帮助我们创建**隔离的、独立的**开发环境，每个项目有自己的依赖包，互不干扰。

---

## 🛠️ 创建虚拟环境

### 方法一：使用 `virtualenv`（第三方库）

**Step 1: 安装 virtualenv**

```bash
pip install virtualenv
```

**Step 2: 创建虚拟环境**

```bash
# 进入你的项目目录
cd your_project_folder

# 创建虚拟环境（venv 是环境名称，可自定义）
virtualenv venv
```

### 方法二：使用 Python 内置 `venv`（推荐）

```bash
# Windows
python -m venv venv

# Mac/Linux
python3 -m venv venv
```

---

## ⚡ 激活虚拟环境

创建后，需要**激活**才能使用：

### Windows PowerShell
```powershell
venv\Scripts\activate
```

### Windows Git Bash
```bash
source venv/Scripts/activate
```

### Mac / Linux
```bash
source venv/bin/activate
```

激活成功后，你会看到命令行前面出现 `(venv)`：

```bash
(venv) C:\Users\NO3Chen\my_project>
```

---

## 📦 在虚拟环境中安装包

激活虚拟环境后，使用 `pip install` 安装的包**只会存在于该环境中**：

```bash
# 安装 Flask
(venv) pip install Flask

# 安装多个包
(venv) pip install requests numpy pandas
```

### 查看已安装的包

```bash
(venv) pip freeze
```

输出示例：
```
click==8.1.7
Flask==3.0.0
itsdangerous==2.1.2
Jinja2==3.1.2
MarkupSafe==2.1.3
Werkzeug==3.0.1
```

### 导出依赖到 requirements.txt

```bash
(venv) pip freeze > requirements.txt
```

### 从 requirements.txt 安装依赖

```bash
(venv) pip install -r requirements.txt
```

---

## 🚪 退出虚拟环境

完成工作后，使用 `deactivate` 命令退出：

```bash
(venv) deactivate
```

命令行前的 `(venv)` 会消失，表示已退出虚拟环境。

---

## 📋 完整工作流程示例

```bash
# 1. 创建项目目录
mkdir flask_project
cd flask_project

# 2. 创建虚拟环境
python -m venv venv

# 3. 激活虚拟环境 (Windows PowerShell)
venv\Scripts\activate

# 4. 安装项目依赖
(venv) pip install Flask requests

# 5. 查看已安装的包
(venv) pip freeze

# 6. 导出依赖
(venv) pip freeze > requirements.txt

# 7. 开发你的项目...

# 8. 完成后退出
(venv) deactivate
```

---

## ⚠️ 重要提示

### 1. 将 venv 加入 .gitignore

虚拟环境文件夹**不应该**提交到 Git 仓库！

创建 `.gitignore` 文件：
```
venv/
__pycache__/
*.pyc
```

### 2. 团队协作流程

```bash
# 克隆项目后
git clone <project_url>
cd project

# 创建自己的虚拟环境
python -m venv venv

# 激活环境
venv\Scripts\activate  # Windows

# 安装项目依赖
pip install -r requirements.txt
```

---

## 🎯 虚拟环境 vs 全局环境 对比

| 特性 | 全局环境 | 虚拟环境 |
|------|----------|----------|
| 包隔离 | ❌ 所有项目共享 | ✅ 每个项目独立 |
| 版本冲突 | ❌ 容易发生 | ✅ 完全避免 |
| 项目迁移 | ❌ 困难 | ✅ 使用requirements.txt轻松迁移 |
| 清理 | ❌ 麻烦 | ✅ 删除venv文件夹即可 |

---

## 💻 练习

1. 创建一个新的项目目录 `my_flask_app`
2. 在其中创建虚拟环境
3. 激活虚拟环境
4. 安装 Flask 和 requests
5. 使用 `pip freeze` 查看已安装的包
6. 导出依赖到 `requirements.txt`
7. 退出虚拟环境

---

> 📌 **教授寄语**：虚拟环境是Python项目管理的基石。养成为每个项目创建独立虚拟环境的好习惯，你会发现开发变得更加干净、有序！

🎉 **恭喜你完成 Day 23！**

